'use strict';

class Admin {
    constructor(name) {
        this.mod = name;

        $('select.chosen').chosen({allow_single_deselect: true, no_results_text: 'Ничего не найдено', width: '300px'});

        $('.br-toggle').click(function() {
            let toogleId = $(this).data('id');

            if ($(this).hasClass('on')) {
                $(this).removeClass('on');
                $('#' + toogleId).prop('checked', false);
            } else {
                $(this).addClass('on');
                $('#' + toogleId).prop('checked', 'checked');
            }
        });
    }

    alert(info) {
        if (info.error) {
            Growl.error({
                title: 'Ошибка',
                text: info.text
            });
        } else {
            Growl.info({
                title: 'Успех',
                text: info.text
            });
        }
    }
    
    ajaxSend(data, action, callback) {
        $.post('/engine/lazydev/' + this.mod + '/admin/ajax/ajax.php', {data: data, action: action, dle_hash: dle_login_hash}, function(info) {
            info = jQuery.parseJSON(info);
            if (info.text) {
                coreAdmin.alert(info);
            }
            if (callback) {
                return callback(info);
            }
        });
        if (!callback) {
            return false;
        }
    }

}

/* pytesNET/tail.select v.0.5.15 | Basic Version | @author SamBrishes, pytesNET <sam@pytes.net> | @license MIT */
(function(a,b){"function"==typeof define&&define.amd?define(function(){return b(a)}):"object"==typeof module&&module.exports?module.exports=b(a):("undefined"==typeof a.tail&&(a.tail={}),a.tail.select=b(a),"undefined"!=typeof jQuery&&(jQuery.fn.tailselect=function(a){var b,c=[];return this.each(function(){!1!==(b=tail.select(this,a))&&c.push(b)}),1===c.length?c[0]:0!==c.length&&c}),"undefined"!=typeof MooTools&&Element.implement({tailselect:function(a){return new tail.select(this,a)}}))})(window,function(a){"use strict";function b(a,b){return!!(a&&"classList"in a)&&a.classList.contains(b)}function c(a,b){return a&&"classList"in a?a.classList.add(b):void 0}function f(a,b){return a&&"classList"in a?a.classList.remove(b):void 0}function g(a,b,c){if(CustomEvent&&CustomEvent.name)var d=new CustomEvent(b,c);else{var d=m.createEvent("CustomEvent");d.initCustomEvent(b,!!c.bubbles,!!c.cancelable,c.detail)}return a.dispatchEvent(d)}function h(a,b){if("function"==typeof Object.assign)return Object.assign({},a,b||{});var c=Object.constructor();for(var d in a)c[d]=d in b?b[d]:a[d];return c}function j(a,b){var c=m.createElement(a);return c.className=b&&b.join?b.join(" "):b||"",c}var k,m=a.document,d=function(a,b){if(a="string"==typeof a?m.querySelectorAll(a):a,a instanceof NodeList||a instanceof HTMLCollection||a instanceof Array){for(var c=[],e=a.length,f=0;f<e;f++)c.push(new d(a[f],h(b,{})));return 1===c.length?c[0]:0!==c.length&&c}if(!(a instanceof Element)||!(this instanceof d))return!!(a instanceof Element)&&new d(a,b);if(d.inst[a.getAttribute("data-tail-select")])return d.inst[a.getAttribute("data-tail-select")];if(a.getAttribute("data-select")){var g=JSON.parse(a.getAttribute("data-select").replace(/\'/g,"\""));g instanceof Object&&(b=h(b,g))}var j=a.getAttribute("placeholder")||a.getAttribute("data-placeholder");return b="object"==typeof b?b:{},b.multiple="multiple"in b?b.multiple:a.multiple,b.disabled="disabled"in b?b.disabled:a.disabled,b.placeholder=j||b.placeholder||null,b.width="auto"===b.width?a.offsetWidth+50:b.width,b.sourceBind="bindSourceSelect"in b?b.bindSourceSelect:b.sourceBind||!1,b.sourceHide="sourceHide"in b?b.sourceHide:b.sourceHide||!0,b.multiLimit=0<=b.multiLimit?b.multiLimit:1/0,this.e=a,this.id=++d.count,this.con=h(d.defaults,b),this.events={},d.inst["tail-"+this.id]=this,this.init().bind()};return d.version="0.5.15",d.status="beta",d.count=0,d.inst={},d.defaults={animate:!0,classNames:null,csvOutput:!1,csvSeparator:",",descriptions:!1,deselect:!1,disabled:!1,height:350,hideDisabled:!1,hideSelected:!1,items:{},locale:"en",linguisticRules:{ะต:"\u0451",a:"\xE4",o:"\xF6",u:"\xFC",ss:"\xDF"},multiple:!1,multiLimit:1/0,multiPinSelected:!1,multiContainer:!1,multiShowCount:!0,multiShowLimit:!1,multiSelectAll:!1,multiSelectGroup:!0,openAbove:null,placeholder:null,search:!1,searchConfig:["text","value"],searchFocus:!0,searchMarked:!0,searchMinLength:1,searchDisabled:!0,sortItems:!1,sortGroups:!1,sourceBind:!1,sourceHide:!0,startOpen:!1,stayOpen:!1,width:null,cbComplete:void 0,cbEmpty:void 0,cbLoopItem:void 0,cbLoopGroup:void 0},d.strings={en:{all:"Все",none:"Ничего",actionAll:"Выбрать все",actionNone:"Отменить все",empty:"Здесь пока ничего нет",emptySearch:"Ничего не найдено",limit:"Вы не можете выбрать больше вариантов",placeholder:"Выберите вариант...",placeholderMulti:function(args){let strings = ["варианта", "вариантов", "вариантов"], cases = [2, 0, 1, 1, 1, 2], num = args[":limit"];let string = strings[(num%100 > 4 && num%100 < 20)? 2: cases[(num%10 < 5)? num%10: 5]];return "Выбор до :limit " + string + " ...";},search:"Начните набирать для поиска...",disabled:"Поле отключено"},modify:function(a,b,c){if(!(a in this))return!1;if(b instanceof Object)for(var d in b)this.modify(a,d,b[d]);else this[a][b]="string"==typeof c?c:this[a][b];return!0},register:function(a,b){return!!("string"==typeof a&&b instanceof Object)&&(this[a]=b,!0)}},d.prototype={_e:function(a,b,c){if(!(a in this.__))return c?c:a;var a=this.__[a];if("function"==typeof a&&(a=a.call(this,b)),"object"==typeof b)for(var d in b)a=a.replace(d,b[d]);return a},init:function(){var a=this,b=["tail-select"],e=this.con,f=/^[0-9.]+(?:cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|\%)$/i,g=!0===e.classNames?this.e.className:e.classNames;b.push(g&&g.push?g.join(" "):g&&g.split?g:"no-classes"),e.hideSelected&&b.push("hide-selected"),e.hideDisabled&&b.push("hide-disabled"),0==e.multiLimit&&b.push("disabled"),e.multiple&&b.push("multiple"),e.deselect&&b.push("deselect"),e.disabled&&b.push("disabled"),this.__=h(d.strings.en,d.strings[e.locale]||{}),this._init=!0,this._query=!1,this.select=j("DIV",b),this.label=j("DIV","select-label"),this.dropdown=j("DIV","select-dropdown"),this.search=j("DIV","dropdown-search"),this.csvInput=j("INPUT","select-search"),null===this.e.getAttribute("tabindex")?this.select.setAttribute("tabindex",0):this.select.setAttribute("tabindex",this.e.getAttribute("tabindex")),e.width&&f.test(e.width)?this.select.style.width=e.width:e.width&&!isNaN(parseFloat(e.width,10))&&(this.select.style.width=e.width+"px"),this.label.addEventListener("click",function(){a.toggle.call(a,a.con.animate)}),this.select.appendChild(this.label),isNaN(parseInt(e.height,10))||(this.dropdown.style.maxHeight=parseInt(e.height,10)+"px"),e.search&&(this.search.innerHTML="<input type=\"text\" class=\"search-input\" />",this.search.children[0].placeholder=this._e("search"),this.search.children[0].addEventListener("input",function(){a.query.call(a,this.value.length>e.searchMinLength?this.value:void 0)}),this.dropdown.appendChild(this.search)),this.select.appendChild(this.dropdown),this.csvInput.type="hidden",e.csvOutput&&(this.csvInput.name=this.e.name,this.e.removeAttribute("name"),this.select.appendChild(this.csvInput)),e.multiple&&e.multiContainer&&(m.querySelector(e.multiContainer)?(this.container=m.querySelector(e.multiContainer),this.container.className+=" tail-select-container"):!0===e.multiContainer&&(this.container=this.label,this.container.className+=" tail-select-container")),this.options=new k(this.e,this);for(var c=this.e.options.length,l=0;l<c;l++)this.options.set(this.e.options[l],!1);for(var n in e.items)"string"==typeof e.items[n]&&(e.items[n]={value:e.items[n]}),this.options.add(e.items[n].key||n,e.items[n].value,e.items[n].group,e.items[n].selected,e.items[n].disabled,e.items[n].description);return this.query(),this.e.nextElementSibling?this.e.parentElement.insertBefore(this.select,this.e.nextElementSibling):this.e.parentElement.appendChild(this.select),e.sourceHide&&("none"==this.e.style.display?(this.select.style.display="none",this.e.setAttribute("data-select-hidden","display")):"hidden"==this.e.style.visibility?(this.select.style.visibiltiy="hidden",this.e.setAttribute("data-select-hidden","visibility")):(this.e.style.display="none",this.e.setAttribute("data-select-hidden","0"))),this.e.setAttribute("data-tail-select","tail-"+this.id),a.con.startOpen&&this.open(e.animate),(e.cbComplete||function(){}).call(this,this.select),(this._init=!1)?this:this},bind:function(){var a=this;return(m.addEventListener("keydown",function(d){var g,h,i,j,k,l=d.keyCode||d.which,m=32==l&&a.select===document.activeElement;if(!m&&(!b(a.select,"active")||0>[13,27,38,40].indexOf(l)))return!1;if(d.preventDefault(),d.stopPropagation(),32===l)return a.open(a.con.animate);if(13==l&&(g=a.dropdown.querySelector(".dropdown-option.hover:not(.disabled)"))&&a.options.select.call(a.options,g),27==l||13==l)return a.close(a.con.animate);if(g=a.dropdown.querySelector(".dropdown-option.hover:not(.disabled)")){f(g,"hover"),i=[(40==l?"next":"previous")+"ElementSibling"];do{if(g=null!==(j=g[i])&&"LI"==g.tagName?j:!!(null!==(j=g.parentElement[i])&&0<j.children.length&&"UL"==j.tagName)&&j.children[40==l?0:j.children.length-1],g&&(!b(g,"dropdown-option")||b(g,"disabled")))continue;break}while(!0)}if(g||40!=l?!g&&38==l&&(k=a.dropdown.querySelectorAll(".dropdown-option:not(.disabled)"),g=k[k.length-1]):g=a.dropdown.querySelector(".dropdown-option:not(.disabled)"),g&&(h=a.dropdown.querySelector(".dropdown-inner"))){var n=function(a){for(var b={top:a.offsetTop,height:a.offsetHeight};(a=a.parentElement)!=h;)b.top+=a.offsetTop;return b}(g);c(g,"hover"),h.scrollTop=Math.max(0,n.top-2*n.height)}return!0}),m.addEventListener("click",function(c){if(!b(a.select,"active")||b(a.select,"idle"))return!1;if(!0===a.con.stayOpen)return!1;for(var d=[a.e,a.select,a.container],e=d.length,f=0;f<e;f++){if(d[f]&&(d[f].contains(c.target)||d[f]==c.target))return!1;if(!c.target.parentElement)return!1}return a.close.call(a,a.con.animate)}),!!!this.con.sourceBind)||(this.e.addEventListener("change",function(b){if(null!=b.detail)return!1;if(b.preventDefault(),b.stopPropagation(),!this.multiple&&this.selectedIndex)a.options.select.call(a.options,this.options[this.selectedIndex]);else{var c=[].concat(a.options.selected),d=[].filter.call(this.querySelectorAll("option:checked"),function(a){return!(0<=c.indexOf(a))||(c.splice(c.indexOf(a),1),!1)});a.options.walk.call(a.options,"unselect",c),a.options.walk.call(a.options,"select",d)}}),!0)},callback:function(a,b,d){var e=a.key.replace(/('|\\)/g,"\\$1"),g=a.group.replace(/('|\\)/g,"\\$1");if("rebuild"==b)return this.query();var h=this.dropdown.querySelector("[data-key='"+e+"'][data-group='"+g+"']");return h&&0<=["select","disable"].indexOf(b)?c(h,"select"==b?"selected":"disabled"):h&&0<=["unselect","enable"].indexOf(b)&&f(h,"unselect"==b?"selected":"disabled"),this.update(a),!0===d||this.trigger("change",a,b)},trigger:function(a){if(this._init)return!1;var b={bubbles:!1,cancelable:!0,detail:{args:arguments,self:this}};"change"==a&&arguments[2]&&0<=arguments[2].indexOf("select")&&(g(this.e,"input",b),g(this.e,"change",b)),g(this.select,"tail::"+a,b);var c,d=[];return Array.prototype.map.call(arguments,function(a,b){0<b&&d.push(a)}),(this.events[a]||[]).forEach(function(a){c=[].concat(d),c.push(a.args||null),(a.cb||function(){}).apply(b.detail.self,c)}),!0},calc:function(){var b=this.dropdown.cloneNode(!0),d=this.con.height,e=0,g=this.dropdown.querySelector(".dropdown-inner");b=this.dropdown.cloneNode(!0),b.style.cssText="height:auto;min-height:auto;max-height:none;opacity:0;display:block;visibility:hidden;",b.style.maxHeight=this.con.height+"px",b.className+=" cloned",this.dropdown.parentElement.appendChild(b),d=d>b.clientHeight?b.clientHeight:d,this.con.search&&(e=b.querySelector(".dropdown-search").clientHeight),this.dropdown.parentElement.removeChild(b);var h=this.select.getBoundingClientRect(),i=a.innerHeight-(h.top+h.height),j=!!(d+e>i)&&h.top>i;return!0===this.con.openAbove||!1!==this.con.openAbove&&j?(j=!0,d=Math.min(d,h.top-10),c(this.select,"open-top")):(j=!1,d=Math.min(d,i-10),f(this.select,"open-top")),g&&(this.dropdown.style.maxHeight=d+"px",g.style.maxHeight=d-e+"px"),this},query:function(a,c){var d,e,f,h,i,k,l=this,m=this.con,n="getAttribute",g=j("DIV","dropdown-inner"),o=a?"finder":"walker",p=a?[a,c]:[m.sortItems,m.sortGroups];for(this._query="string"==typeof a&&a;d=this.options[o].apply(this.options,p);){if(!f||f&&f[n]("data-group")!==d.group)if(e=(m.cbLoopGroup||this.cbGroup).call(this,d.group,a,g),e instanceof Element)f=e,f.setAttribute("data-group",d.group),g.appendChild(f);else break;if(null!==(h=(m.cbLoopItem||this.cbItem).call(this,d,f,a,g))){if(!1===h)break;h.setAttribute("data-key",d.key),h.setAttribute("data-group",d.group),h.addEventListener("click",function(){if(!this.hasAttribute("data-key"))return!1;var a=this[n]("data-key"),b=this[n]("data-group")||"#";l.options.toggle.call(l.options,a,b)&&!1===l.con.stayOpen&&!l.con.multiple&&l.close.call(l,l.con.animate)}),f.appendChild(h)}}var q=g.querySelectorAll("*[data-key]").length;0==q&&(this.con.cbEmpty||function(a){var b=j("SPAN","dropdown-empty");b.innerText=this._e("empty"),a.appendChild(b)}).call(this,g,a),0<q&&m.multiple&&m.multiLimit==1/0&&m.multiSelectAll&&(i=j("BUTTON","tail-all"),k=j("BUTTON","tail-none"),i.innerText=this._e("all"),i.addEventListener("click",function(a){a.preventDefault();var b=l.dropdown.querySelectorAll(".dropdown-inner .dropdown-option");l.options.walk.call(l.options,"select",b)}),k.innerText=this._e("none"),k.addEventListener("click",function(a){a.preventDefault();var b=l.dropdown.querySelectorAll(".dropdown-inner .dropdown-option");l.options.walk.call(l.options,"unselect",b)}),h=j("SPAN","dropdown-action"),h.appendChild(i),h.appendChild(k),g.insertBefore(h,g.children[0]));var r=this.dropdown.querySelector(".dropdown-inner");return this.dropdown[(r?"replace":"append")+"Child"](g,r),b(this.select,"active")&&this.calc(),this.updateCSV().updateLabel()},cbGroup:function(a){var b,c,d=j("UL","dropdown-optgroup"),e=this;return"#"==a?d:(d.innerHTML="<li class=\"optgroup-title\"><b>"+a+"</b></li>",this.con.multiple&&this.con.multiLimit==1/0&&this.con.multiSelectAll&&(b=j("BUTTON","tail-none"),c=j("BUTTON","tail-all"),b.innerText=this._e("none"),b.addEventListener("click",function(a){a.preventDefault();var b=this.parentElement.parentElement.getAttribute("data-group");e.options.all.call(e.options,"unselect",b)}),c.innerText=this._e("all"),c.addEventListener("click",function(a){a.preventDefault();var b=this.parentElement.parentElement.getAttribute("data-group");e.options.all.call(e.options,"select",b)}),d.children[0].appendChild(b),d.children[0].appendChild(c)),d)},cbItem:function(a,b,c){var d=j("LI","dropdown-option"+(a.selected?" selected":"")+(a.disabled?" disabled":""));return c&&0<c.length&&this.con.searchMarked?(c=this.options.applyLinguisticRules(c),d.innerHTML=a.value.replace(new RegExp("("+c+")","i"),"<mark>$1</mark>")):d.innerText=a.value,this.con.descriptions&&a.description&&(d.innerHTML+="<span class=\"option-description\">"+a.description+"</span>"),d},update:function(a){return this.updateLabel().updateContainer(a).updatePin(a).updateCSV(a)},updateLabel:function(a){if(this.container==this.label&&0<this.options.selected.length)return this.label.querySelector(".label-inner")&&this.label.removeChild(this.label.querySelector(".label-inner")),this.label.querySelector(".label-count")&&this.label.removeChild(this.label.querySelector(".label-count")),this;var d,e=this.con,c=this.options.selected.length;return"string"!=typeof a&&(e.disabled?a="disabled":0==this.dropdown.querySelectorAll("*[data-key]").length?a="empty"+(b(this.select,"in-search")?"Search":""):e.multiLimit<=c?a="limit":!e.multiple&&0<this.options.selected.length?a=this.options.selected[0].innerText:"string"==typeof e.placeholder?a=e.placeholder:a="placeholder"+(e.multiple&&e.multiLimit<1/0?"Multi":"")),a=this._e(a,{":limit":e.multiLimit},a),a="<span class=\"label-inner\">"+a+"</span>",d=e.multiShowLimit&&e.multiLimit<1/0,e.multiple&&e.multiShowCount&&(a="<span class=\"label-count\">:c</span>"+a,a=a.replace(":c",c+(d?" / "+e.multiLimit:""))),this.label.innerHTML=a,this},updateContainer:function(a){if(!this.container||!this.con.multiContainer)return this;var b="[data-group='"+a.group+"'][data-key='"+a.key+"']";if(this.container.querySelector(b))return a.selected||this.container.removeChild(this.container.querySelector(b)),this;if(a.selected){var c=this,d=j("DIV","select-handle");d.innerText=a.value,d.setAttribute("data-key",a.key),d.setAttribute("data-group",a.group),d.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation();var b=this.getAttribute("data-key"),d=this.getAttribute("data-group");c.options.unselect.call(c.options,b,d)}),this.container.appendChild(d)}return this},updatePin:function(a){var b=this.dropdown.querySelector(".dropdown-inner ul"),c="li[data-key='"+a.key+"'][data-group='"+a.group+"']";if(!this.con.multiPinSelected||!b||!1!==this._query)return this;if(c=this.dropdown.querySelector(c),a.selected)b.insertBefore(c,b.children[0]);else{for(var d=this.dropdown.querySelector("ul[data-group='"+a.group+"']"),e=this.options[a.index-1],f=!1;e&&e.group==a.group&&!(f=d.querySelector("li[data-key='"+e.key+"']"));)e=this.options[e.index-1];f&&f.nextElementSibling?d.insertBefore(c,f.nextElementSibling):d.appendChild(c)}return this},updateCSV:function(){if(!this.csvInput||!this.con.csvOutput)return this;for(var a=[],b=this.options.selected.length,c=0;c<b;c++)a.push(this.options.selected[c].value);return this.csvInput.value=a.join(this.con.csvSeparator||","),this},open:function(a){if(b(this.select,"active")||b(this.select,"idle")||this.con.disabled)return!1;this.calc();var d=function(){c(g.select,"active"),f(g.select,"idle"),this.dropdown.style.height="auto",this.dropdown.style.overflow="visible",this.label.removeAttribute("style"),this.con.search&&this.con.searchFocus&&this.dropdown.querySelector("input").focus(),this.trigger.call(this,"open")},g=this,i=this.dropdown.style;return!1===a?(i.cssText="height:"+i.maxHeight+";display:block;overflow:hidden;",d.call(this)):(this.label.style.zIndex=25,this.dropdown.style.cssText+="height:0;display:block;overflow:hidden;",c(g.select,"idle"),function a(){var b=parseInt(i.height,10),c=parseInt(i.maxHeight,10);return b>=c?d.call(g):void(i.height=(b+50>c?c:b+50)+"px",setTimeout(a,20))}()),this},close:function(a){if(!b(this.select,"active")||b(this.select,"idle"))return!1;var d=function(){f(this.select,"active"),f(this.select,"idle"),this.dropdown.removeAttribute("style"),this.dropdown.querySelector(".dropdown-inner").removeAttribute("style"),this.trigger.call(this,"close")},g=this,h=this.dropdown;return!1===a?d.call(this):(c(this.select,"idle"),this.dropdown.style.overflow="hidden",function a(){return 0>=parseInt(h.offsetHeight,10)-50?d.call(g):void(h.style.height=parseInt(h.offsetHeight,10)-50+"px",setTimeout(a,20))}()),this},toggle:function(a){return b(this.select,"active")?this.close(a):b(this.select,"idle")?this:this.open(a)},remove:function(){if(this.e.removeAttribute("data-tail-select"),this.e.hasAttribute("data-select-hidden")&&("0"==this.e.getAttribute("data-select-hidden")&&this.e.style.removeProperty("display"),this.e.removeAttribute("data-select-hidden")),Array.prototype.map.call(this.e.querySelectorAll("[data-select-option='add']"),function(a){a.parentElement.removeChild(a)}),Array.prototype.map.call(this.e.querySelectorAll("[data-select-optgroup='add']"),function(a){a.parentElement.removeChild(a)}),this.e.name=this.csvInput.hasAttribute("name")?this.csvInput.name:this.e.name,this.select.parentElement&&this.select.parentElement.removeChild(this.select),this.container)for(var a=this.container.querySelectorAll(".select-handle"),b=a.length,c=0;c<b;c++)this.container.removeChild(a[c]);return this},reload:function(){return this.remove().init()},config:function(a,b,c){if(a instanceof Object){for(var d in a)this.config(d,a[d],!1);return this.reload()?this.con:this.con}return"undefined"==typeof a?this.con:!!(a in this.con)&&("undefined"==typeof b?this.con[a]:(this.con[a]=b,!1!==c&&this.reload(),this))},enable:function(a){return f(this.select,"disabled"),this.e.disabled=!1,this.con.disabled=!1,!1===a?this:this.reload()},disable:function(a){return c(this.select,"disabled"),this.e.disabled=!0,this.con.disabled=!0,!1===a?this:this.reload()},on:function(a,b,c){return!(0>["open","close","change"].indexOf(a)||"function"!=typeof b)&&(a in this.events||(this.events[a]=[]),this.events[a].push({cb:b,args:c instanceof Array?c:[]}),this)},value:function(){return 0==this.options.selected.length?null:this.con.multiple?this.options.selected.map(function(a){return a.value}):this.options.selected[0].value}},k=d.options=function(a,b){return this instanceof k?(this.self=b,this.element=a,this.length=0,this.selected=[],this.disabled=[],this.items={"#":{}},this.groups={},this):new k(a,b)},k.prototype={_r:function(a){return a.replace("disabled","disable").replace("enabled","enable").replace("selected","select").replace("unselected","unselect")},get:function(a,b){if("object"==typeof a&&a.key&&a.group)b=a.group||b,a=a.key;else if(a instanceof Element)"OPTION"==a.tagName?(b=a.parentElement.label||"#",a=a.value||a.innerText):a.hasAttribute("data-key")&&(b=a.getAttribute("data-group")||a.parentElement.getAttribute("data-group")||"#",a=a.getAttribute("data-key"));else if("string"!=typeof a)return!1;return a=/^[0-9]+$/.test(a)?"_"+a:a,!!(b in this.items)&&this.items[b][a]},set:function(a,b){var c=a.value||a.innerText,d=a.parentElement.label||"#";if(d in this.items||(this.items[d]={},this.groups[d]=a.parentElement),c in this.items[d])return!1;var e=/^[0-9]+$/.test(c)?"_"+c:c,f=this.self.con;if(f.multiple&&this.selected.length>=f.multiLimit&&(a.selected=!1),a.selected&&f.deselect&&(!a.hasAttribute("selected")||0==f.multiLimit)&&(a.selected=!1,a.parentElement.selectedIndex=-1),a.hasAttribute("data-description")){var g=j("SPAN");g.innerHTML=a.getAttribute("data-description"),a.setAttribute("data-description",g.innerHTML)}return this.items[d][e]={key:c,value:a.text,description:a.getAttribute("data-description")||null,group:d,option:a,optgroup:"#"==d?void 0:this.groups[d],selected:a.selected,disabled:a.disabled,hidden:a.hidden||!1},this.length++,a.selected&&this.select(this.items[d][e]),a.disabled&&this.disable(this.items[d][e]),!b||this.self.callback(this.items[d][c],"rebuild")},add:function(a,b,c,d,e,f,g){if(a instanceof Object){for(var h in a)this.add(a[h].key||h,a[h].value,a[h].group,a[h].selected,a[h].disabled,a[h].description,!1);return this.self.query()}if(this.get(a,c))return!1;if(c="string"==typeof c?c:"#","#"!==c&&!(c in this.groups)){var i=j("OPTGROUP");i.label=c,i.setAttribute("data-select-optgroup","add"),this.element.appendChild(i),this.items[c]={},this.groups[c]=i}this.self.con.multiple&&this.selected.length>=this.self.con.multiLimit&&(d=!1),e=!!e;var k=m.createElement("OPTION");return k.value=a,k.selected=d,k.disabled=e,k.innerText=b,k.setAttribute("data-select-option","add"),f&&0<f.length&&k.setAttribute("data-description",f),("#"==c?this.element:this.groups[c]).appendChild(k),this.set(k,g)},move:function(a,b,c,d){if(!(a=this.get(a,b)))return!1;if("#"!==c&&!(c in this.groups)){var e=j("OPTGROUP");e.label=c,this.element.appendChild(e),this.items[c]={},this.groups[c]=e,this.groups[c].appendChild(a.option)}return delete this.items[a.group][a.key],a.group=c,a.optgroup=this.groups[c]||void 0,this.items[c][a.key]=a,!d||this.self.query()},remove:function(a,b,c){if(!(a=this.get(a,b)))return!1;a.selected&&this.unselect(a),a.disabled&&this.enable(a),a.option.parentElement.removeChild(a.option);var d=/^[0-9]+$/.test(a.key)?"_"+a.key:a.key;return delete this.items[a.group][d],this.length--,0===Object.keys(this.items[a.group]).length&&(delete this.items[a.group],delete this.groups[a.group]),!c||this.self.query()},is:function(a,b,c){var a=this._r(a),d=this.get(b,c);return!d||0>["select","unselect","disable","enable"].indexOf(a)?null:"disable"==a||"enable"==a?"disable"==a?d.disabled:!d.disabled:("select"==a||"unselect"==a)&&("select"==a?d.selected:!d.selected)},handle:function(a,c,d,e){var f=this.get(c,d),a=this._r(a);if(!f||0>["select","unselect","disable","enable"].indexOf(a))return null;if("disable"==a||"enable"==a)return f.option in this.disabled||"disable"!=a?f.option in this.disabled&&"enable"==a&&this.disabled.splice(this.disabled.indexOf(f.option),1):this.disabled.push(f.option),f.disabled="disable"==a,f.option.disabled="disable"==a,this.self.callback.call(this.self,f,a);var g=b(this.self.select,"disabled")||f.disabled||f.option.disabled,h=this.self.con.multiple&&this.self.con.multiLimit<=this.selected.length,j=!this.self.con.multiple&&0<this.selected.indexOf(f.option),k=0==this.self.con.multiLimit&&!0==this.self.con.deselect,l=!this.self.con.multiple&&!this.self.con.deselect&&!0!==e;if("select"==a){if(g||h||k||j)return!1;if(!this.self.con.multiple)for(var m in this.selected)this.unselect(this.selected[m],void 0,!0);0>this.selected.indexOf(f.option)&&this.selected.push(f.option)}else if("unselect"==a){if(g||l)return!1;this.selected.splice(this.selected.indexOf(f.option),1)}return f.selected="select"==a,f.option.selected="select"==a,f.option[(6<a.length?"remove":"set")+"Attribute"]("selected","selected"),this.self.callback.call(this.self,f,a,e)},enable:function(a,b){return this.handle("enable",a,b,!1)},disable:function(a,b){return this.handle("disable",a,b,!1)},select:function(a,b){return this.handle("select",a,b,!1)},unselect:function(a,b,c){return this.handle("unselect",a,b,c)},toggle:function(a,b){return!!(a=this.get(a,b))&&this.handle(a.selected?"unselect":"select",a,b,!1)},invert:function(a){if(a=this._r(a),0<=["enable","disable"].indexOf(a))var b=this.disabled,c="enable"==a?"disable":"enable";else if(0<=["select","unselect"].indexOf(a))var b=this.selected,c="select"==a?"unselect":"select";var d=Array.prototype.filter.call(this,function(a){return!(a in b)}),e=this;return[].concat(b).forEach(function(a){e.handle.call(e,c,a)}),[].concat(d).forEach(function(b){e.handle.call(e,a,b)}),!0},all:function(a,b){var c=this,d=this;return b in this.items?d=Object.keys(this.items[b]):0<=["unselect","enable"].indexOf(a)&&(d=[].concat("unselect"==a?this.selected:this.disabled)),Array.prototype.forEach.call(d,function(d){c.handle.call(c,a,d,b,!1)}),!0},walk:function(a,b,c){if(b instanceof Array||b.length)for(var d=b.length,e=0;e<d;e++)this.handle.apply(this,[a,b[e],null].concat(c));else if(b instanceof Object){var f=this;if(b.forEach)b.forEach(function(b){f.handle.apply(f,[a,b,null].concat(c))});else for(var g in b)("string"==typeof b[g]||"number"==typeof b[g]||b[g]instanceof Element)&&this.handle.apply(this,[a,b[g],g in this.items?g:null]).concat(c)}return this},applyLinguisticRules:function(a,b){var c=this.self.con.linguisticRules,d=[];return Object.keys(c).forEach(function(a){d.push("("+a+"|["+c[a]+"])")}),b&&(d=d.concat(d.map(function(a){return a.toUpperCase()}))),a.replace(new RegExp(d.join("|"),b?"g":"ig"),function(a){return d[[].indexOf.call(arguments,a,1)-1]})},find:function(a,b){var c,d=this,e={};if(b||(b=this.self.con.searchConfig),"function"==typeof b)c=b.bind(this,a);else{b=b instanceof Array?b:[b],b.forEach(function(a){"string"==typeof a&&(e[a]=!0)}),e.any=e.any?e.any:e.attributes&&e.value,(!e.regex||e.text)&&(a=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),e.exactglyphes||(a=this.self.options.applyLinguisticRules(a,e.case)),e.word&&(a="\\b"+a+"\\b");var f=new RegExp(a,e.case?"m":"mi"),g=function(a){return f.test(a.text||a.value)};if(c=e.any?function(a){return g(a)||[].some.call(a.attributes,g)}:e.attributes?function(a){return[].some.call(a.attributes,g)}:g,!this.self.con.searchDisabled){var h=c;c=function(a){return!a.disabled&&h(a)}}}return[].filter.call(this.self.e.options,c).map(function(a){return!a.hidden&&d.get(a)})},finder:function(a,b){void 0===this._finderLoop&&(this._finderLoop=this.find(a,b));for(var c;void 0!==(c=this._finderLoop.shift());)return c;return delete this._finderLoop,!1},walker:function(a,b){if("undefined"!=typeof this._inLoop&&this._inLoop){if(0<this._inItems.length){do var c=this.items[this._inGroup][this._inItems.shift()];while(!0===c.hidden);return c}if(0<this._inGroups.length){for(;0<this._inGroups.length;){var d=this._inGroups.shift();if(!(d in this.items))return!1;var e=Object.keys(this.items[d]);if(0<e.length)break}return"ASC"==a?e.sort():"DESC"==a?e.sort().reverse():"function"==typeof a&&(e=a.call(this,e)),this._inItems=e,this._inGroup=d,this.walker(null,null)}return delete this._inLoop,delete this._inItems,delete this._inGroup,delete this._inGroups,!1}var f=Object.keys(this.groups)||[];return"ASC"==b?f.sort():"DESC"==b?f.sort().reverse():"function"==typeof b&&(f=b.call(this,f)),f.unshift("#"),this._inLoop=!0,this._inItems=[],this._inGroups=f,this.walker(a,null)}},d});

/*! jQuery UI - v1.12.1 - 2020-01-15
* http://jqueryui.com
* Includes: widget.js, data.js, scroll-parent.js, widgets/sortable.js, widgets/mouse.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */

(function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){t.ui=t.ui||{},t.ui.version="1.12.1";var e=0,i=Array.prototype.slice;t.cleanData=function(e){return function(i){var s,n,o;for(o=0;null!=(n=i[o]);o++)try{s=t._data(n,"events"),s&&s.remove&&t(n).triggerHandler("remove")}catch(a){}e(i)}}(t.cleanData),t.widget=function(e,i,s){var n,o,a,r={},h=e.split(".")[0];e=e.split(".")[1];var l=h+"-"+e;return s||(s=i,i=t.Widget),t.isArray(s)&&(s=t.extend.apply(null,[{}].concat(s))),t.expr[":"][l.toLowerCase()]=function(e){return!!t.data(e,l)},t[h]=t[h]||{},n=t[h][e],o=t[h][e]=function(t,e){return this._createWidget?(arguments.length&&this._createWidget(t,e),void 0):new o(t,e)},t.extend(o,n,{version:s.version,_proto:t.extend({},s),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(s,function(e,s){return t.isFunction(s)?(r[e]=function(){function t(){return i.prototype[e].apply(this,arguments)}function n(t){return i.prototype[e].apply(this,t)}return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=n,e=s.apply(this,arguments),this._super=i,this._superApply=o,e}}(),void 0):(r[e]=s,void 0)}),o.prototype=t.widget.extend(a,{widgetEventPrefix:n?a.widgetEventPrefix||e:e},r,{constructor:o,namespace:h,widgetName:e,widgetFullName:l}),n?(t.each(n._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete n._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var s,n,o=i.call(arguments,1),a=0,r=o.length;r>a;a++)for(s in o[a])n=o[a][s],o[a].hasOwnProperty(s)&&void 0!==n&&(e[s]=t.isPlainObject(n)?t.isPlainObject(e[s])?t.widget.extend({},e[s],n):t.widget.extend({},n):n);return e},t.widget.bridge=function(e,s){var n=s.prototype.widgetFullName||e;t.fn[e]=function(o){var a="string"==typeof o,r=i.call(arguments,1),h=this;return a?this.length||"instance"!==o?this.each(function(){var i,s=t.data(this,n);return"instance"===o?(h=s,!1):s?t.isFunction(s[o])&&"_"!==o.charAt(0)?(i=s[o].apply(s,r),i!==s&&void 0!==i?(h=i&&i.jquery?h.pushStack(i.get()):i,!1):void 0):t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; "+"attempted to call method '"+o+"'")}):h=void 0:(r.length&&(o=t.widget.extend.apply(null,[o].concat(r))),this.each(function(){var e=t.data(this,n);e?(e.option(o||{}),e._init&&e._init()):t.data(this,n,new s(o,this))})),h}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(i,s){s=t(s||this.defaultElement||this)[0],this.element=t(s),this.uuid=e++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},s!==this&&(t.data(s,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===s&&this.destroy()}}),this.document=t(s.style?s.ownerDocument:s.document||s),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),i),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,function(t,i){e._removeClass(i,t)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s,n,o,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},s=e.split("."),e=s.shift(),s.length){for(n=a[e]=t.widget.extend({},this.options[e]),o=0;s.length-1>o;o++)n[s[o]]=n[s[o]]||{},n=n[s[o]];if(e=s.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=i}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var i,s,n;for(i in e)n=this.classesElementLookup[i],e[i]!==this.options.classes[i]&&n&&n.length&&(s=t(n.get()),this._removeClass(n,i),s.addClass(this._classes({element:s,keys:i,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){function i(i,o){var a,r;for(r=0;i.length>r;r++)a=n.classesElementLookup[i[r]]||t(),a=e.add?t(t.unique(a.get().concat(e.element.get()))):t(a.not(e.element).get()),n.classesElementLookup[i[r]]=a,s.push(i[r]),o&&e.classes[i[r]]&&s.push(e.classes[i[r]])}var s=[],n=this;return e=t.extend({element:this.element,classes:this.options.classes||{}},e),this._on(e.element,{remove:"_untrackClassesElement"}),e.keys&&i(e.keys.match(/\S+/g)||[],!0),e.extra&&i(e.extra.match(/\S+/g)||[]),s.join(" ")},_untrackClassesElement:function(e){var i=this;t.each(i.classesElementLookup,function(s,n){-1!==t.inArray(e.target,n)&&(i.classesElementLookup[s]=t(n.not(e.target).get()))})},_removeClass:function(t,e,i){return this._toggleClass(t,e,i,!1)},_addClass:function(t,e,i){return this._toggleClass(t,e,i,!0)},_toggleClass:function(t,e,i,s){s="boolean"==typeof s?s:i;var n="string"==typeof t||null===t,o={extra:n?e:i,keys:n?t:e,element:n?this.element:t,add:s};return o.element.toggleClass(this._classes(o),s),this},_on:function(e,i,s){var n,o=this;"boolean"!=typeof e&&(s=i,i=e,e=!1),s?(i=n=t(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),t.each(s,function(s,a){function r(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+o.eventNamespace,c=h[2];c?n.on(l,c,r):i.on(l,r)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(i).off(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return("string"==typeof t?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,i,s){var n,o,a=this.options[e];if(s=s||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,s),!(t.isFunction(a)&&a.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,o){"string"==typeof n&&(n={effect:n});var a,r=n?n===!0||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),a=!t.isEmptyObject(n),n.complete=o,n.delay&&s.delay(n.delay),a&&t.effects&&t.effects.effect[r]?s[e](n):r!==e&&s[r]?s[r](n.duration,n.easing,o):s.queue(function(i){t(this)[e](),o&&o.call(s[0]),i()})}}),t.widget,t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])}}),t.fn.scrollParent=function(e){var i=this.css("position"),s="absolute"===i,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=t(this);return s&&"static"===e.css("position")?!1:n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&o.length?o:t(this[0].ownerDocument||document)},t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var s=!1;t(document).on("mouseup",function(){s=!1}),t.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).on("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!s){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,n=1===e.which,o="string"==typeof this.options.cancel&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:!1;return n&&!o&&this._mouseCapture(e)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),s=!0,!0)):!0}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)if(e.originalEvent.altKey||e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,s=!1,e.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),t.widget("ui.sortable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){var e=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),t.each(this.items,function(){e._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var s=null,n=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,o.widgetName+"-item")===o?(s=t(this),!1):void 0}),t.data(e.target,o.widgetName+"-item")===o&&(s=t(e.target)),s?!this.options.handle||i||(t(this.options.handle,s).find("*").addBack().each(function(){this===e.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(e,i,s){var n,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=t("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,s,n,o,a=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+a.scrollSpeed:e.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+a.scrollSpeed:e.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(e.pageY-this.document.scrollTop()<a.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-a.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<a.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+a.scrollSpeed)),e.pageX-this.document.scrollLeft()<a.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-a.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<a.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+a.scrollSpeed))),r!==!1&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],o=this._intersectsWithPointer(s),o&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],n):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(e,s),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,n=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new t.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+"="),s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,o=t.left,a=o+t.width,r=t.top,h=r+t.height,l=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||s+l>r&&h>s+l,d="y"===this.options.axis||e+c>o&&a>e+c,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>o&&a>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e,i,s="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),n="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),o=s&&n;return o?(e=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection(),this.floating?"right"===i||"down"===e?2:1:e&&("down"===e?2:1)):!1},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&e||"up"===s&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){r.push(this)}var s,n,o,a,r=[],h=[],l=this._connectWith();if(l&&e)for(s=l.length-1;s>=0;s--)for(o=t(l[s],this.document[0]),n=o.length-1;n>=0;n--)a=t.data(o[n],this.widgetFullName),a&&a!==this&&!a.options.disabled&&h.push([t.isFunction(a.options.items)?a.options.items.call(a.element):t(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);for(h.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,s,n,o,a,r,h,l,c=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(n=t(d[i],this.document[0]),s=n.length-1;s>=0;s--)o=t.data(n[s],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(u.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]),this.containers.push(o));for(i=u.length-1;i>=0;i--)for(a=u[i][1],r=u[i][0],s=0,l=r.length;l>s;s++)h=t(r[s]),h.data(this.widgetName+"-item",a),c.push({item:h,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,o;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item,e||(s.width=n.outerWidth(),s.height=n.outerHeight()),o=n.offset(),s.left=o.left,s.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+s+">",e.document[0]);return e._addClass(n,"ui-sortable-placeholder",i||e.currentItem[0].className)._removeClass(n,"ui-sortable-helper"),"tbody"===s?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(n)):"tr"===s?e._createTrPlaceholder(e.currentItem,n):"img"===s&&n.attr("src",e.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(t,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),s.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var s=this;e.children().each(function(){t("<td>&#160;</td>",s.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(e){var i,s,n,o,a,r,h,l,c,u,d=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&t.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,o=null,c=d.floating||this._isFloating(this.currentItem),a=c?"left":"top",r=c?"width":"height",u=c?"pageX":"pageY",s=this.items.length-1;s>=0;s--)t.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[a],l=!1,e[u]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(e[u]-h)&&(n=Math.abs(e[u]-h),o=this.items[s],this.direction=l?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;o?this._rearrange(e,o,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=t(n.containment)[0],i=t(n.containment).offset(),s="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*s}
    },_generatePosition:function(e){var i,s,n=this.options,o=e.pageX,a=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((a-this.originalPageY)/n.grid[1])*n.grid[1],a=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0],o=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(t,e){function i(t,e,i){return function(s){i._trigger(t,s,e._uiHash(e))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)e||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(s=0;n.length>s;s++)n[s].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})});